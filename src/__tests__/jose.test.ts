import { verifyToken } from "../jose"

const encrypted: string =
  "eyJraWQiOiJIOEkrXC9DRVQzajZRRm03VUFXWHUzbDdQWU1ZVlQ2aEl3TDN0MTJQVHFlST0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIwNTM2MWJiZS01Zjk1LTQ0YWQtOWFhMy03NmJjYmU2YmVhODQiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuYXAtbm9ydGhlYXN0LTEuYW1hem9uYXdzLmNvbVwvYXAtbm9ydGhlYXN0LTFfa3pNbzNjWFk3IiwiY2xpZW50X2lkIjoiNHJuYnIzMHRzZnA1OHRtNzh2NmxuZTNxMiIsIm9yaWdpbl9qdGkiOiI5ZDkxOTNiYy1jOTBhLTQ3N2UtOTRlNy1lZGZhMDhkMDY5ODIiLCJldmVudF9pZCI6ImExMTZkZGQ2LWVmZGQtNDYyYy04M2YyLTEyMDc2ZTk1NjZjMiIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2ODYyMDExMjUsImV4cCI6MTY4NjI4NzUyNSwiaWF0IjoxNjg2MjAxMTI1LCJqdGkiOiJkOGQ2NzJiMi1iN2RjLTRiOTMtOGQ2My0yZGU5NDFmMjZhNTYiLCJ1c2VybmFtZSI6IjA1MzYxYmJlLTVmOTUtNDRhZC05YWEzLTc2YmNiZTZiZWE4NCJ9.M6DYUuQWvdgYCN17rZl2RlHr0p3m220OW_DeOyXdQe9N1HsWL1R3XlQMVXVhfuNwwHs-ZIUnQ19fuk91aeS5qdpRNTd5n5CF70H52XQMBwCIMMhnqhG7p6RSpKLR3qKm0FhZaZIRydFvBvxy1rfVO_lCAi5mjucL7-2v8Sqd5B_2g3JimPEeHo9nhPIjq_tkHBnqUf-M15iEX7NDIjVnoBwlpeKqo4KKvSQG4hGywvKYa0OzLbSvbQImrlCjX827lMrLGsUlNQJ97CPl-j8hzmqM_zNcCFek1G8StbbL2yCbLkXpGR-g9J7rhd89Cpw_MRj-4LtJuaDoGmOoySYVqA"

test("basic", () => {
  expect.assertions(1)
  return verifyToken(encrypted).then((data) =>
    expect(data).toHaveProperty("sub")
  )
})
